
const data = [
  {
    a:1,
    id:1,
    img:"./img/Hoodies/HlgUc0rzrKvyFnhOWylOuc782A7LB8ZnCBK6HOuM.jpg",
    p1:"Palastine",
    p2:"150",
    statu:false,
    p3:"Hoodie",
  },
  {
    a:1,
    id:2,
    img:"./img/Hoodies/LZLPCdKXepvdL327hIbEnZVlXcDC2VYiCGBkKnGu.jpg",
    p1:"Spider",
    p2:"150",
    statu:false,
    p3:"Hoodie",
  },
  {
    a:1,
    id:3,
    img:"./img/Hoodies/QaHsVaMoANDvmvr27Az0tlzAkfWRXzLbWd2o8igR.jpg",
    p1:"pablo",
    p2:"150",
    statu:false,
    p3:"Hoodie",
  },
  {
    a:1,
    id:4,
    img:"./img/Hoodies/XK4fQ6qZdotEGDnJ1O01uOK30m4vflSuAuOsmJUb.jpg",
    p1:"Minim",
    p2:"150",
    statu:false,
    p3:"Hoodie",
  },
  {
    a:1,
    id:5,
    img:"./img/LongsleeveT-shirts/c3J7YcajPtqZsNRhPUGR7uGZRGikQSrcopOqLslE.jpg",
    p1:"I don't care",
    p2:"150",
    statu:false,
    p3:"Long sleeve T-shirts",
  },
  {
    a:1,
    id:6,
    img:"./img/LongsleeveT-shirts/c6QB1s4wQO89f4D8GT5moQ0fHccWNES3ocDDml2s.jpg",
    p1:"Zamalek",
    p2:"150",
    statu:false,
    p3:"Long sleeve T-shirts",
  },
  {
    a:1,
    id:7,
    img:"./img/OversizedHoodies/au7CWmr5Oorj93FlEbCE19DcAwTyjuPjsmzWoh39.jpg",
    p1:"Moon",
    p2:"150",
    statu:false,
    p3:"Oversized Hoodies",
  },
  {
    a:1,
    id:8,
    img:"./img/OversizedHoodies/Bv1A9TUIB0HwtcDLYhVDKzOPuawRVOXp0aDzwKPF.jpg",
    p1:"Stitch",
    p2:"150",
    statu:false,
    p3:"Oversized Hoodies",
  },
  {
    a:1,
    id:9,
    img:"./img/OversizedHoodies/epV2gKC6ofhqfXZJJIe6UmUty1hHMiAKc0SFDdyO.jpg",
    p1:"Skull",
    p2:"150",
    statu:false,
    p3:"Oversized Hoodies",
  },
  {
    a:1,
    id:10,
    img:"./img/OversizedHoodies//yrJT4btFuKT3XfX5WYqVVNdrEYm8KkYkO9OZ3IKr.jpg",
    p1:"Tupac",
    p2:"150",
    statu:false,
    p3:"Oversized Hoodies",
  },
  {
    a:1,
    id:11,
    img:"./img/OversizedT-shirts/4dKlChHq9wAhCLHN7yJtrGcpnGD2YouIVrEe8upu.jpg",
    p1:"Nike",
    p2:"150",
    statu:false,
    p3:"Oversized T-shirts",
  },
  {
    a:1,
    id:12,
    img:"./img/OversizedT-shirts/61hG9vtrfzVXcPaj8bFF6UkEKbTGfLreIOAs55Wo.jpg",
    p1:"Spider-shirt",
    p2:"150",
    statu:false,
    p3:"Oversized T-shirts",
  },
  {
    a:1,
    id:13,
    img:"./img/OversizedT-shirts/WlfQkKjhly7bFAninrOq6vLIW3JHIB1eAiPbmiTs.jpg",
    p1:"Red Bull",
    p2:"150",
    statu:false,
    p3:"Oversized T-shirts",
  },
  {
    a:1,
    id:14,
    img:"./img/Sweatshirts/DmFqXZ2v89Iy0h32PCzE8grUtAyQ9v9dOSVLXtQw.jpg",
    p1:"Javascript",
    p2:"150",
    statu:false,
    p3:"Sweatshirts",
  },
  {
    a:1,
    id:15,
    img:"./img/Sweatshirts/L4l0vnZrumU3LzASMDSeDnTLPlsQ97D5hSg95ixS.jpg",
    p1:"Al-Ahly",
    p2:"150",
    statu:false,
    p3:"Sweatshirts",
  },
  {
    a:1,
    id:16,
    img:"./img/Sweatshirts/wAGWaej8013CQXWZgLRZBaoYCzP3sH8vFgrPgI6d.jpg",
    p1:"Marvel",
    p2:"150",
    statu:false,
    p3:"Sweatshirts",
  },
  {
    a:1,
    id:17,
    img:"./img/Sweatshirts/ZXOpO19sBqwdKp6EwHuW3idIiiistkzA69QFwRbi.jpg",
    p1:"Naruto",
    p2:"150",
    statu:false,
    p3:"Sweatshirts",
  },
  {
    a:1,
    id:18,
    img:"./img/T-shirt/045MC1OuCfYkvL6aeb3XLasRwIG7UIDJmrMAj9G6.jpg",
    p1:"Cairokee",
    p2:"150",
    statu:false,
    p3:"T-shirt",
  },
  {
    a:1,
    id:19,
    img:"./img/T-shirt/aV4A1VweckuzW8lJTf3GkHS19xFf3DodJXUnF7Sr.jpg",
    p1:"Horn",
    p2:"150",
    statu:false,
    p3:"T-shirt",
  },
  {
    a:1,
    id:20,
    img:"./img/T-shirt/eHMgCAYGF6mkyE0b5T5NDmgI9znQzkRmX88PLeV4.jpg",
    p1:"Game of thrones",
    p2:"150",
    statu:false,
    p3:"T-shirt",
  }
]
//const mydata = data.map((item)=>{return item}) 
//let add_to_cart123 = document.querySelectorAll("#add_to_cart43");
//let removetocart = document.querySelectorAll(".removetocart");
//localStorage.setItem("pro" , JSON.stringify(data))
var  foavorite ;
let v = document.querySelector(".products")
var c;
function load(){
 
    let y = data.map((item)=>
     {
         return `
         <div class="card">
             <img src= ${item.img} class="card-img-top" alt="pic" height="170px">
             <div class="card-body">
               <p class="card-text">Product : ${item.p1}</p>
               <p class="card-text">Price : ${item.p2} $</p>
               <p class="card-text">Category : ${item.p3}</p>
               <div class="buttons">
               <button id="myId-${item.id}" class="btn btn-outline-dark add_to_cart43" onClick="addToCart(${item.id})"><p>Add to cart</p></button>
               <button id="myId2-${item.id}" class="btn btn-outline-danger removetocart" onClick="removeToCart(${item.id})"><p>remove from cart</p></button>
                 <i id="fa-${item.id}" class="fas fa-heart" style="color: grey;"></i>
               </div>
             </div>
           </div>
       </div>`
     })

     v.innerHTML = y.join("")

     if (localStorage.getItem("pric")=="[]"||localStorage.getItem("pric")==null) {
          for (let i = 0; i < data.length; i++) {
                 change1(data[i].id).style.display = "block";
                 change2(data[i].id).style.display = "none";
          }
     }
     else
     {
      for (let i = 0; i < data.length; i++) {
        change1(data[i].id).style.display = "block";
        change2(data[i].id).style.display = "none";
        }
     }
     mybtn();
     myfa();
    
   // console.log(add_to_cart123);


    
    
   

  let icon = document.querySelectorAll(".fa-heart")
  for (let index = 0; index < icon.length; index++) {
   icon[index].addEventListener('click',()=>
   {
      if (localStorage.getItem("username")) {
        if(icon[index].style.color == "red"){
          icon[index].style.color = "grey";
          loadCart23()
          delet(index)
        }
      else{
        icon[index].style.color = "red";
        loadCart23()
         checker(index)
      }
      }
      else
      {
          window.location ="login.html";
      }
   })
 }
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////


load()
mybtn()
var selected = 0;
let search_by_cat = document.querySelector(".asde").addEventListener('change',(e)=>
{
    selected = e.target.value;
})
let search_by_control = document.querySelector(".search_by_control");






search_by_control.addEventListener('keyup' , (e)=> {
  const search = e.target.value.toLowerCase();
  
  if(selected==0)
  {
  const y = data.filter((item)=>
  {
      return (
        item.p1.toLocaleLowerCase().includes(search)
      )
  })
  displayItems(y); 
  } 
  else
  {
    const y = data.filter((item)=>
  {
      return (
        item.p3.toLocaleLowerCase().includes(search)
      )
  })
  displayItems(y); 
  }  
})


const displayItems = (items)=>
{
     let das = items.map((item)=>
     {
      return `
      <div class="card">
          <img src= ${item.img} class="card-img-top" alt="pic" height="170px">
          <div class="card-body">
            <p class="card-text">Product : ${item.p1}</p>
            <p class="card-text">Price : ${item.p2} $</p>
            <p class="card-text">Category : ${item.p3}</p>
            <div class="buttons">
            <button id="myId-${item.id}" class="btn btn-outline-dark add_to_cart43" onClick="addToCart(${item.id})"><p>Add to cart</p></button>
            <button style="display:none;" id="myId2-${item.id}" class="btn btn-outline-danger removetocart" onClick="removeToCart(${item.id})"><p>remove from cart</p></button>
              <i id="fa-${item.id}" class="fas fa-heart" style="color: grey;"></i>
            </div>
          </div>
        </div>
    </div>`
     })
     v.innerHTML = das.join("");
    loadCart23()
      let re = JSON.parse(localStorage.getItem("pric"));
      for (let i = 0; i < re.length; i++) {
          change1(re[i]).style.display = "none";
          change2(re[i]).style.display = "block";
      }
     
  let icon = document.querySelectorAll(".fa-heart");
  myfa()
  for(let index = 0; index < icon.length; index++) {
   icon[index].addEventListener('click',()=>
   {
      if (localStorage.getItem("username")) {
        if(icon[index].style.color == "red"){
          icon[index].style.color = "grey";
          loadCart23()
          delet(index)
        }
      else{
        icon[index].style.color = "red";
        loadCart23()
         checker(index)
      }
      }
      else
      {
          window.location ="login.html";
      }
   })
 }
 
}
/////////////////////////////////////////////////////////////////////////////////////////
let cart = document.querySelector(".cart");
function load_cart() {
  cart.style.display ="block";
  cart.innerHTML = "";
  let art = JSON.parse(localStorage.getItem("carts"));
  for (let i = 0; i < art.length; i++) {
    cart.innerHTML +=
     `<div class="element_div">
     <div>
     <p class="elem">${art[i].p1}</p> 
     </div>
     <div class="icon_plus">
     <p>${art[i].a}</p>
     <button onClick="quantity1(${art[i].id})"><i class="fas fa-plus"></i></button> 
     <button onClick="quantity2(${art[i].id})"><i class="fas fa-minus"></i></button>
     </div> 
     </div>`
  }
  as.innerHTML = `${art.length}`;
  if(art.length>0)
      cart.innerHTML += `<button class="btn btn-dark d-block mx-auto mt-2" type="submit"><a href="cart.html">Veiw all products</a></button>`
}


//////////////////////////////////////////////////////////////////////////////////////////

let as = document.querySelector(".num h6");

/////////////////////////////////////////////////////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////////////////////
function loadCart23() {
  arr = JSON.parse(localStorage.getItem("carts")) || [];
  arrt = JSON.parse(localStorage.getItem("pric")) || [];
  foavorite = JSON.parse(localStorage.getItem("favo")) || [];
  as.innerHTML = `${arr.length}`;
}

window.addEventListener("load",loadCart23);


//let arr = JSON.parse(localStorage.getItem("Carts")) || [];
///////////////////////////////////////////////////////////////////////////////////////////////

function updatecart(item) {
   let array = JSON.parse(localStorage.getItem("carts"))
    for (let i = 0; i < array.length; i++) {
        if (item.id === array[i].id) {
             array[i].a++;
        }
    }
    localStorage.setItem("carts",JSON.stringify(array));
    loadCart23();
    as.innerHTML = `${array.length}`
    load_cart(); 
}
/////////////////////////////////////

let er = document.querySelector(".ico");
er.addEventListener('click',()=>
{
  load_cart()
})

//////////////////////////////////////////////////////////////////////////////////////////////
function addToCart(id) {
if (localStorage.getItem("username")) 
{
let choose_item = data.find((item)=> item.id === id);

let cv = arr.find((item)=> item.id === id);
if(cv===undefined)
{
  // choose_item.a++;
  // choose_item.statu = true;
  arr.push(choose_item)
  localStorage.setItem("carts", JSON.stringify(arr));
  arrt.push(choose_item.id)
  localStorage.setItem("pric" , JSON.stringify(arrt));
  mybtn();
  load_cart();
}
else
{
   updatecart(cv);
}

}
  else
  {
      window.location = "login.html";
  }
}
////////////////////////////////////////////////////////////////////////

function removeToCart(id)
{
  let fert = JSON.parse(localStorage.getItem("pric"))
  const index = fert.findIndex(number => number === id)
  if(index !== -1)
           fert.splice(index,1);
  localStorage.setItem("pric" , JSON.stringify(fert))

  ////////////////////////////////////////////////////////////////
  let defr2 = JSON.parse(localStorage.getItem("carts"))
  let choose_item = defr2.find((item)=> item.id === id);
  const index2 = defr2.findIndex(number => number === choose_item)
      if(index2 !== -1)
           defr2.splice(index2,1);
  localStorage.setItem("carts" , JSON.stringify(defr2))
  //console.log(index2);
  //////////////////////////////////////////////////////////////
  loadCart23()
  change2(id).style.display = "none";
  change1(id).style.display = "block";
  load_cart()
}


/////////////////////////////////////////////////////////////////////////

function mybtn() {
    let cbv = JSON.parse(localStorage.getItem("pric"))
    if (cbv==null) {
      return;
    }
    for (let i = 0; i < cbv.length; i++) {
    if (cbv[i]!=undefined) {
       change1(cbv[i]).style.display = "none";
       change2(cbv[i]).style.display = "block";
    }
    else{
        change1(cbv[i]).style.display = "block";
        change2(cbv[i]).style.display = "none";
    }
  }
}




function change1(id) {
  const asde = "myId-"+id;
  let der = document.getElementById(asde);
  return der;
}
function change2(id) {
  const asde = "myId2-"+id;
  let der = document.getElementById(asde);
  return der;
}
function checker(id) {
    id++;
    //loadCart23()
    let df = foavorite;
    let def = df.find((item) => item === id)
    if (def==undefined) {
      foavorite.push(id)
    }
    localStorage.setItem("favo",JSON.stringify(foavorite))
    
}
function delet(id) {
  id++;
  let df = JSON.parse(localStorage.getItem("favo"));
  const index = df.findIndex(number => number === id);
  if(index !== -1){ 
      df.splice(index,1);
  }
  localStorage.setItem("favo",JSON.stringify(df))
}
function change3(id) {
  const asde = "fa-"+id;
  //console.log(asde);
  let def = document.getElementById(asde)
  return def;
}
function myfa() {
   let des2 = JSON.parse(localStorage.getItem("favo"));

  if (des2==null) {
    return;
  }
  for (let i = 0; i < des2.length; i++) {
      change3(des2[i]).style.color = "red"
  }
}
////////////////////////////////////////////////////////////////////////
function quantity1(id)
{
  let sdw = JSON.parse(localStorage.getItem("carts"))
  for (let i = 0; i < sdw.length; i++) {
    if (sdw[i].id===id) {
        sdw[i].a++;
    }
  }
  localStorage.setItem("carts",JSON.stringify(sdw))
  load_cart();
}

function quantity2(id)
{
  let fert = JSON.parse(localStorage.getItem("carts"))
  let choose_item = fert.find((item)=> item.id === id);
      choose_item.a=0;
      const index = fert.findIndex(number => number === choose_item)
      fert[index].a = 0;
      if(index !== -1){ 
          fert.splice(index,1);
      }
         
  localStorage.setItem("carts" , JSON.stringify(fert))
  //////////////////////////////////////////////////////////////////////

  let def = JSON.parse(localStorage.getItem("pric"))
  const index3 = def.findIndex(number => number === id)
  if(index3 !== -1){
    def.splice(index3,1);
  }               
  localStorage.setItem("pric" , JSON.stringify(def))
  loadCart23();
  change1(id).style.display = "block";
  change2(id).style.display = "none";
  load_cart();
}




///////////////////////////////////////////////////////////////////////////////////////////


let user_info = document.querySelector("#user_info");
let user = document.querySelector("#user");
let links = document.querySelector(".links");
let links2 = document.querySelector(".links2");

if (localStorage.getItem("username")) {
    links.remove()
    user_info.style.display ="block";
    links2.style.display = "block";
    user.innerHTML = "Welcome "+localStorage.getItem("username");
}

let Logout = document.querySelector("#Logout");
Logout.addEventListener('click',()=>
{
    localStorage.removeItem("username");
    localStorage.removeItem("email");
    localStorage.removeItem("password");
    localStorage.removeItem("carts");
    setTimeout(()=>
    {
      window.location = "login.html"
    },1500)
})




